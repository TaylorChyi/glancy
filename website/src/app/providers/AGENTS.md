# website/src/app/providers 层级军规

## 背景与愿景

- 背景：`app` 层负责将 UI、路由、状态桥接到具体的页面布局，需要统一的 Provider 组合点来注入跨页面能力。
- 目标：通过在此目录集中维护应用级 Provider，确保依赖顺序与作用域可追溯，避免在各个页面中散落配置造成耦合。
- 设计取舍：采用“组合根容器 + 职责内聚子目录”的组织方式，优先延续 React 组合式架构，拒绝一次性脚本式挂载。

## 目录结构职责

- `AppProviders/`
  - 职责：维护根组件的 Provider 装配顺序（例如 国际化、状态管理、数据同步等），并输出统一的 `AppProviders` 组合入口。
  - 约束：
    - 任何 Provider 必须在本目录内通过显式函数或组件组合完成，严禁在页面或特性层绕过此处直接挂载。
    - 引入新 Provider 前需在本目录补充注释记录其依赖关系、失败退化策略与扩展点，必要时拆分为独立模块以保持单一职责。
- 未来扩展目录
  - 若出现跨页面但具备独立生命周期的 Provider（例如 授权态、Feature Toggle、可观测性埋点），请为其新建同名子目录，内含 `index.tsx` 作为公开入口与补充文档解释设计决策。
  - 引入与基础设施交互的 Provider 时，应额外在子目录内创建 `README.md` 说明配置来源、安全约束与替代方案。

## 贡献与演进要求

- Provider 装配顺序发生调整时，需同步在变更描述中说明原因、影响范围与回滚方案，并评估对页面渲染性能的影响。
- 引入第三方依赖（例如 状态管理库、监控 SDK）时，必须在提交中阐述引入必要性、体积与安全考量，并在此文件补充对应目录职责。
- 所有新增文件需包含背景、目的、关键取舍等注释，保持“代码即文档”的可读性，确保后续演进成本可控。
