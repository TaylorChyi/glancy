.modal-shell {
  /*
   * 为举报弹窗提供独立的色彩令牌，既强化层级感，也避免影响共用的 modal-content 基线样式。
   */
  --report-modal-surface: color-mix(
    in srgb,
    var(--app-bg) 90%,
    var(--color-surface-alt)
  );

  /*
   * 复用 SettingsSurface 的边框对比度，确保举报弹窗与偏好设置面板在视觉上保持一致的厚度与明暗层级。
   * 备选方案：单独定义举报弹窗的色板，但会造成主题维护分叉，故放弃。
   */
  --report-modal-border: color-mix(in srgb, var(--border-color) 64%, transparent);
  --report-modal-shadow: 0 48px 120px
    color-mix(in srgb, var(--shadow-color) 32%, transparent);
  --report-modal-inner-surface: color-mix(
    in srgb,
    var(--preferences-panel-surface, var(--app-bg)) 94%,
    transparent
  );
  --report-modal-inner-border: color-mix(
    in srgb,
    var(--preferences-panel-border, var(--border-color)) 58%,
    transparent
  );
  --report-modal-inner-shadow: 0 36px 96px
    color-mix(in srgb, var(--shadow-color) 24%, transparent);

  /*
   * 通过单独的留白令牌统一内边距尺度，既方便未来接入响应式调整，也能在保证 SettingsSurface 宽度约束的同时，
   * 为模态与内容体之间预留更充裕的呼吸空间。
   * 备选方案：直接调整 SettingsSurface 的 width 或 margin，但那会破坏组件在其他上下文下的尺寸语义，故弃用。
   */
  --report-modal-gutter: clamp(var(--space-6), 7vw, var(--space-9));

  /*
   * 依据订阅面板的新版视觉规范，压缩圆角以强调面板的建筑感，
   * 同时通过提升描边对比度（外层 64%、内层 58%）让层级关系更清晰。
   * 备选方案：保留旧描边（46%）但改圆角，测试后发现会让面板显得浮，故弃用。
   */
  --report-modal-radius: var(--radius-xl, 20px);
}

:global(.modal-content).modal-shell {
  background: var(--report-modal-surface);
  color: var(--preferences-panel-text, var(--color-text));
  padding: var(--report-modal-gutter);
  border-radius: var(--report-modal-radius);
  border: 1px solid var(--report-modal-border);
  box-shadow: var(--report-modal-shadow);
}

.plain-surface {
  background: var(--report-modal-inner-surface);
  border-radius: var(--report-modal-radius);
  border: 1px solid var(--report-modal-inner-border);
  box-shadow: var(--report-modal-inner-shadow);
}

:global(.modal-content) :where(.plain-surface) {
  /*
   * 在模态容器作用域内确保内层面板继承我们定义的底色与阴影，
   * 以呼应 SettingsSurface 的玻璃化质感并保持视觉统一。
   */
  background: var(--report-modal-inner-surface);
  border-radius: var(--report-modal-radius);
  border: 1px solid var(--report-modal-inner-border);
  box-shadow: var(--report-modal-inner-shadow);
}

.header {
  display: grid;
  grid-template-columns: auto 1fr auto;
  align-items: center;
  gap: clamp(var(--space-2), 2.4vw, var(--space-3));
  padding-bottom: clamp(var(--space-3), 3vw, var(--space-4));
  border-bottom: 1px solid
    color-mix(in srgb, var(--preferences-panel-border, var(--border-color)) 32%, transparent);
}

.header-close {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: clamp(36px, 6vw, 44px);
  height: clamp(36px, 6vw, 44px);
  border-radius: var(--radius-xl);
  border: 1px solid transparent;
  background: color-mix(
    in srgb,
    var(--preferences-panel-surface, var(--app-bg)) 80%,
    transparent
  );
  color: var(--preferences-panel-text, var(--color-text));
  font-size: clamp(20px, 3vw, 22px);
  line-height: 1;
  cursor: pointer;
  transition:
    background 160ms ease,
    border-color 160ms ease,
    transform 160ms ease,
    box-shadow 160ms ease;
}

.header-close:hover {
  background: color-mix(
    in srgb,
    var(--preferences-panel-ring, var(--highlight-color)) 18%,
    var(--app-bg)
  );
  border-color: color-mix(
    in srgb,
    var(--preferences-panel-ring, var(--highlight-color)) 45%,
    transparent
  );
  transform: translateY(-1px);
}

.header-close:focus-visible {
  outline: none;
  border-color: var(--preferences-panel-ring, var(--highlight-color));
  box-shadow: 0 0 0 3px
    color-mix(in srgb, var(--preferences-panel-ring, var(--highlight-color)) 28%, transparent);
}

.header-title {
  margin: 0;
  font-size: clamp(var(--text-xl), 3vw, var(--text-2xl));
  font-weight: var(--font-bold);
  letter-spacing: 0.08em;
  text-transform: uppercase;
  text-align: center;
  color: var(--preferences-panel-text, var(--color-text));
}

.header-spacer {
  display: inline-flex;
  width: clamp(36px, 6vw, 44px);
  height: clamp(36px, 6vw, 44px);
}

.summary {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
  gap: clamp(var(--space-3), 3vw, var(--space-5));
  margin: 0;
  padding: clamp(var(--space-3), 3vw, var(--space-4));
  border-radius: var(--radius-xl);
  border: 1px solid
    color-mix(in srgb, var(--preferences-panel-border, var(--border-color)) 55%, transparent);
  background: color-mix(
    in srgb,
    var(--preferences-panel-surface, var(--app-bg)) 92%,
    transparent
  );
}

.summary-item {
  display: grid;
  gap: var(--space-1);
  align-content: start;
  min-width: 0;
}

.summary-label {
  margin: 0;
  font-size: var(--text-xs);
  letter-spacing: 0.12em;
  text-transform: uppercase;
  color: color-mix(
    in srgb,
    var(--preferences-panel-muted, var(--color-text)) 76%,
    transparent
  );
}

.summary-value {
  margin: 0;
  font-size: clamp(var(--text-lg), 2.4vw, var(--text-xl));
  font-weight: var(--font-semibold);
  line-height: 1.5;
  color: var(--preferences-panel-text, var(--color-text));
  overflow-wrap: anywhere;
}

.fieldset {
  margin: 0;
  padding: 0;
  border: none;
  display: grid;
  gap: clamp(var(--space-3), 3vw, var(--space-4));
}

.legend {
  margin: 0;
  font-size: var(--text-sm);
  font-weight: var(--font-semibold);
  letter-spacing: 0.06em;
  text-transform: uppercase;
  color: var(--preferences-panel-text, var(--color-text));
}

.segment-group {
  display: inline-flex;
  flex-wrap: wrap;
  gap: var(--space-1);
  padding: clamp(var(--space-1), 1.6vw, var(--space-2));
  border-radius: var(--radius-2xl);
  border: 1px solid
    color-mix(
      in srgb,
      var(--preferences-panel-border, var(--border-color)) 55%,
      transparent
    );
  background: color-mix(
    in srgb,
    var(--preferences-panel-surface, var(--app-bg)) 70%,
    transparent
  );
}

.segment {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  min-width: 108px;
  padding: 0.65rem 1.25rem;
  border: 1px solid transparent;
  border-radius: var(--radius-xl);
  background: transparent;
  color: color-mix(
    in srgb,
    var(--preferences-panel-muted, currentColor) 82%,
    transparent
  );
  font-size: var(--text-sm);
  font-weight: var(--font-semibold);
  letter-spacing: 0.04em;
  cursor: pointer;
  transition:
    background 160ms ease,
    color 160ms ease,
    transform 160ms ease,
    box-shadow 160ms ease,
    border-color 160ms ease;
}

.segment:focus-visible {
  outline: none;
  border-color: var(--preferences-panel-ring, var(--highlight-color));
  box-shadow: 0 0 0 3px
    color-mix(in srgb, var(--preferences-panel-ring, var(--highlight-color)) 32%, transparent);
}

.segment:disabled {
  opacity: 0.6;
  cursor: not-allowed;
}

.segment:hover:not(:disabled) {
  color: var(--preferences-panel-text, var(--color-text));
  border-color: color-mix(
    in srgb,
    var(--preferences-panel-ring, var(--highlight-color)) 42%,
    transparent
  );
  transform: translateY(-1px);
}

.segment-active {
  background: color-mix(
    in srgb,
    var(--preferences-panel-ring, var(--highlight-color)) 24%,
    var(--app-bg)
  );
  color: var(--preferences-panel-text, var(--color-text));
  border-color: color-mix(
    in srgb,
    var(--preferences-panel-ring, var(--highlight-color)) 55%,
    transparent
  );
  transform: translateY(-2px);
  box-shadow: 0 18px 36px
    color-mix(in srgb, var(--shadow-color) 22%, transparent);
}

.textarea {
  width: 100%;
  min-height: 140px;
  padding: clamp(var(--space-3), 3vw, var(--space-4));
  border-radius: var(--radius-xl);
  border: 1px solid
    color-mix(in srgb, var(--preferences-panel-ring, var(--border-color)) 55%, transparent);
  background: color-mix(in srgb, var(--preferences-panel-surface, var(--app-bg)) 94%, transparent);
  color: var(--preferences-panel-text, var(--color-text));
  font-size: var(--text-sm);
  line-height: 1.7;
  resize: vertical;
}

.textarea:focus-visible {
  outline: none;
  border-color: var(--preferences-panel-ring, var(--highlight-color));
  box-shadow: 0 0 0 3px
    color-mix(in srgb, var(--preferences-panel-ring, var(--highlight-color)) 35%, transparent);
}

.action-bar {
  display: flex;
  align-items: center;
  gap: clamp(var(--space-3), 3vw, var(--space-4));
  width: 100%;
}

.action-status {
  flex: 1;
  min-height: 1.5rem;
}

.error {
  margin: 0;
  font-size: var(--text-xs);
  color: color-mix(in srgb, var(--danger-color, #f87171) 85%, transparent);
}

.action-buttons {
  display: inline-flex;
  gap: var(--space-3);
  justify-content: flex-end;
}

.ghost-button {
  min-width: 132px;
  padding: 0.75rem 1.4rem;
  border-radius: var(--radius-lg);
  border: 1px solid
    color-mix(in srgb, var(--preferences-panel-border, var(--border-color)) 55%, transparent);
  background: transparent;
  color: color-mix(in srgb, var(--preferences-panel-text, var(--color-text)) 88%, transparent);
  font-weight: var(--font-semibold);
  letter-spacing: 0.06em;
  text-transform: uppercase;
  cursor: pointer;
}

.primary-button {
  min-width: 160px;
  padding: 0.85rem 1.6rem;
  border-radius: var(--radius-lg);
  border: none;
  background: linear-gradient(
    135deg,
    color-mix(in srgb, var(--primary-bg) 94%, transparent) 0%,
    color-mix(in srgb, var(--primary-bg) 72%, transparent) 100%
  );
  color: var(--primary-color);
  font-weight: var(--font-semibold);
  letter-spacing: 0.08em;
  text-transform: uppercase;
  cursor: pointer;
  box-shadow: 0 24px 56px
    color-mix(in srgb, var(--shadow-color) 28%, transparent);
  transition:
    transform 160ms ease,
    box-shadow 160ms ease;
}

.primary-button:focus-visible {
  outline: none;
  transform: translateY(-1px);
  box-shadow:
    0 32px 72px color-mix(in srgb, var(--shadow-color) 38%, transparent),
    0 0 0 3px color-mix(in srgb, var(--highlight-color) 32%, transparent);
}

.primary-button:disabled,
.ghost-button:disabled {
  opacity: 0.6;
  cursor: not-allowed;
}

.primary-button:hover:not(:disabled) {
  transform: translateY(-2px);
  box-shadow: 0 28px 64px
    color-mix(in srgb, var(--shadow-color) 34%, transparent);
}

@media (width <= 599px) {
  .modal-shell {
    /*
     * 在窄屏下收敛外层留白以避免可视区域被过度压缩，同时保留最小安全间距防止内容贴边。
     */
    --report-modal-gutter: clamp(var(--space-4), 8vw, var(--space-6));
  }

  .summary {
    grid-template-columns: 1fr;
    padding: clamp(var(--space-3), 4vw, var(--space-4));
  }

  .segment {
    min-width: 100%;
  }

  .action-bar {
    flex-direction: column;
    align-items: stretch;
  }

  .action-status {
    min-height: auto;
  }

  .action-buttons {
    flex-direction: column;
    align-items: stretch;
  }
}
