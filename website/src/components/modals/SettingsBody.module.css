/**
 * 背景：
 *  - SettingsBody 迁移到组件内维护网格与滚动，避免页面/模态重复编排布局细节。
 * 目的：
 *  - 定义双栏布局与滚动策略，确保左右区域在模态及独立页面中都能保持可预测的高度与滚动行为。
 * 关键决策与取舍：
 *  - 采用 CSS Grid 生成列宽，通过 CSS 自定义属性暴露安全边距与列间距，便于调用方主题化。
 *  - 左右列分别封装滚动容器，防止外层遮罩承担滚动职责，保障 body 锁定逻辑持续生效。
 * 影响范围：
 *  - SettingsModal、Preferences 页面、后续重用 SettingsBody 的容器。
 * 演进与TODO：
 *  - TODO: 视需要扩展 data-stack 属性以支持抽屉式导航等更复杂的交互模式。
 */

.container {
  display: grid;
  grid-template-columns: var(
    --settings-body-grid-template,
    minmax(220px, 0.36fr) minmax(0, 1fr)
  );
  grid-template-rows: minmax(0, 1fr);
  gap: var(--settings-body-column-gap, 36px);

  /*
   * 通过锁定容器高度，确保模态在不同分区间切换时不发生跳动，
   * 并在右侧内容溢出时依赖内部滚动容器承接滚动职责。
   */
  /* stylelint-disable-next-line declaration-empty-line-before */

  --settings-body-height-fallback: calc(
    100vh - var(--settings-body-safe-area, 160px)
  );
  /* stylelint-disable-next-line declaration-empty-line-before */
  height: var(--settings-body-height, var(--settings-body-height-fallback));
  /* stylelint-disable-next-line declaration-empty-line-before */
  max-height: var(--settings-body-height, var(--settings-body-height-fallback));
  min-height: 0;
  width: 100%;
  align-items: stretch;
  overflow: hidden;
}

.nav-column {
  display: flex;
  flex-direction: column;
  min-width: 0;
  min-height: 0;
  overflow: hidden;
}

.nav-scroller {
  position: relative;
  display: flex;
  flex-direction: column;
  flex: 1;
  min-height: 0;
  max-height: 100%;
  overflow-y: auto;
  overscroll-behavior: contain;
  scrollbar-gutter: stable both-edges;
  padding-right: 4px;
}

.nav-scroller > * {
  flex: 1;
  min-height: 0;
}

.content-column {
  display: flex;
  flex-direction: column;
  min-width: 0;
  min-height: 0;
  overflow: hidden;
  position: relative;
  border-inline-start: var(--settings-body-divider-width, 1px) solid
    var(
      --settings-body-divider-color,
      var(
        --sb-divider,
        color-mix(in srgb, var(--border-color, #1f2937) 70%, transparent 30%)
      )
    );
}

.content-scroller {
  flex: 1;
  min-height: 0;
  overflow-y: auto;
  overscroll-behavior: contain;
  scrollbar-gutter: stable both-edges;
  padding-right: 4px;
}

/*
 * 通过绝对定位的探针容器测量参考分区高度，确保主区域保持稳定高度。
 * visibility: hidden 避免干扰键盘与屏幕阅读器；contain: layout 限制重排影响范围。
 */
.measurement-probe {
  position: absolute;
  inset: 0 auto auto 0;
  width: 100%;
  pointer-events: none;
  visibility: hidden;
  overflow: hidden;
  contain: layout;
}

.measurement-probe > * {
  display: block;
  width: 100%;
}

@media (width <= 1023px) {
  .container {
    grid-template-columns: 1fr;
    grid-template-rows: auto minmax(0, 1fr);
    height: auto;
    max-height: none;
    gap: var(--settings-body-column-gap-mobile, 28px);
  }

  .nav-column {
    overflow: visible;
  }

  .nav-scroller {
    flex: none;
    max-height: none;
    overflow: hidden auto;
    padding-right: 0;
    padding-bottom: 6px;
    scroll-padding-inline: 16px;
    scrollbar-gutter: auto;
  }

  .nav-scroller > * {
    /*
     * 当设置面板切换为单列布局时，让导航容器占满可用宽度，
     * 避免 min-content 触发横向滚动并破坏等宽栅格。此处使用 100%
     * 而非固定像素，方便未来根据内容动态扩展列数。
     */
    min-width: 100%;
  }

  .content-column {
    border-inline-start: none;
  }

  .content-scroller {
    max-height: none;
    padding-right: 0;
  }
}
