/**
 * 背景：
 *  - Loader 动画自 2025-03 起强调“中心显现、向外扩展，再向内收束”的节奏，需更精细的遮罩控制。
 * 目的：
 *  - 通过 CSS 模块统一管理透明度与遮罩扩散过渡，让 Hook 输出布尔态即可驱动方向性渐隐渐显。
 *  - 引入 mask + currentColor 的组合，将素材颜色响应式映射到当前主题文本色。
 * 关键决策与取舍：
 *  - 使用径向遮罩与 `mask-size` 过渡替代 clip-path，便于在淡入淡出过程中引入羽化模糊；
 *  - 所有时长仍交由 CSS 变量控制，方便主题或无障碍场景动态调整。
 */
.loader {
  display: grid;
  place-items: center;
  inline-size: 100%;
  min-block-size: var(--vh, 100vh);
  padding: var(--space-4);
  background: transparent;
  color: var(--loader-symbol-color, var(--role-on-surface, currentColor));
}

.symbol {
  position: relative;
  inline-size: min(
    80vw,
    calc(var(--waiting-frame-aspect-ratio) * var(--waiting-frame-height))
  );
  block-size: var(--waiting-frame-height);
  aspect-ratio: var(--waiting-frame-aspect-ratio);
  display: flex;
  align-items: center;
  justify-content: center;
  background: none;
  border: none;
  box-shadow: none;
  border-radius: 0;
  isolation: isolate;
  color: inherit;
}

.frame {
  position: relative;
  inline-size: 100%;
  block-size: 100%;
  overflow: hidden;
  opacity: 0;
  transition:
    opacity var(--waiting-fade-duration, 1000ms) ease-in-out,
    mask-size var(--waiting-fade-duration, 1000ms) ease-in-out,
    -webkit-mask-size var(--waiting-fade-duration, 1000ms) ease-in-out;
  mask-image: radial-gradient(
    circle at center,
    rgb(0 0 0 / 100%) calc(100% - var(--waiting-reveal-softness, 12%)),
    rgb(0 0 0 / 0%) 100%
  );
  mask-repeat: no-repeat;
  mask-position: center;
  mask-size: 0% 0%;
  /* stylelint-disable property-no-vendor-prefix */
  -webkit-mask-image: radial-gradient(
    circle at center,
    rgb(0 0 0 / 100%) calc(100% - var(--waiting-reveal-softness, 12%)),
    rgb(0 0 0 / 0%) 100%
  );
  -webkit-mask-repeat: no-repeat;
  -webkit-mask-position: center;
  -webkit-mask-size: 0% 0%;
  /* stylelint-enable property-no-vendor-prefix */
}

.frame-visible {
  opacity: 1;
  mask-size: var(--waiting-reveal-mask-visible-size, 140%)
    var(--waiting-reveal-mask-visible-size, 140%);
  /* stylelint-disable property-no-vendor-prefix */
  -webkit-mask-size: var(--waiting-reveal-mask-visible-size, 140%)
    var(--waiting-reveal-mask-visible-size, 140%);
  /* stylelint-enable property-no-vendor-prefix */
}

.frame-asset {
  inline-size: 100%;
  block-size: 100%;
  display: block;
  color: inherit;
  background-color: currentcolor;
  mask-image: var(--waiting-frame-image);
  mask-repeat: no-repeat;
  mask-size: contain;
  mask-position: center;
  /* stylelint-disable property-no-vendor-prefix */
  -webkit-mask-image: var(--waiting-frame-image);
  -webkit-mask-repeat: no-repeat;
  -webkit-mask-size: contain;
  -webkit-mask-position: center;
  /* stylelint-enable property-no-vendor-prefix */
}

.label {
  position: absolute;
  inline-size: 1px;
  block-size: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

@media (width <= 480px) {
  .symbol {
    inline-size: min(
      90vw,
      calc(var(--waiting-frame-aspect-ratio) * var(--waiting-frame-height))
    );
  }
}
