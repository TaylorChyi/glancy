# LLM 组件军规

- **模型职责单一**：`model` 子包只承载数据结构定义（记录、枚举、DTO），严禁掺入业务流程、状态转换或外部调用逻辑，确保序列化与验证职责集中。
- **服务聚焦编排**：`service` 子包仅负责调用编排与上下文拼装，依赖注入 `llm`、`prompt`、`stream` 等组件组合出端到端流程，禁止在此层持有底层协议细节或直接构造数据实体。
- **外部模型网关接口化**：所有第三方/自研大模型接入需先在 `llm` 子包定义网关接口，再由具体实现适配客户端；通过 Spring 配置或工厂选择实现，方便扩展 A/B、灰度或本地模拟。
- **流式与 Prompt 解耦**：流式传输处理、增量拼装等逻辑放入 `stream` 子包独立组件，Prompt 模板、拼装策略放入 `prompt` 子包；服务层仅注入并编排它们，确保每个类遵循单一职责原则。
