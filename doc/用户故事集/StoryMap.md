# 用户故事地图

## 发布批次（里程碑）
| 里程碑 | 时间盒 | 主要价值增量 | 覆盖 UC | KPI / SLA 绑定 |
| ------ | ------ | ------------ | ------- | ------------- |
| **M1 · Alpha · 核心查词与可用性** | Sprint 1-2 | 构建端到端流式查词体验并具备自动降级保障 | UC-01 / UC-02 | 查词首屏 P95 ≤ 2.5s；降级响应 P95 ≤ 1.8s；查词可用性 ≥99.9% |
| **M2 · Beta · 数据导出与合规控制** | Sprint 3-4 | 让用户可导出、轮询与清理历史数据，导出链路稳定可追溯 | UC-03 | 导出回执 ≤ 5s；下载链接 TTL 10 分钟；导出队列恢复 ≤ 15 分钟 |
| **M3 · Release · 订阅变更与商业闭环** | Sprint 5-6 | 完成订阅权益同步、支付与账单对账，保障付费体验闭环 | UC-04 / UC-05 | 权益生效 ≤ 5s；账单/支付 API 可用性 ≥99.9%；对账差异率 = 0 |

## 活动→任务→故事
| 活动 | 任务 (Task) | 绑定故事 | 发布批次 | SLA / KPI 映射 |
| ------ | ----------- | -------- | -------- | --------------- |
| 即时查词体验（UC-01） | 输入校验与首屏流式 | ST-01, ST-02 | M1 | 首屏 P95 ≤ 2.5s；输入校验命中率 ≥ 99% |
| 即时查词体验（UC-01） | 模块渲染与可访问体验 | ST-03, ST-10 | M1 | 分片间隔 ≤ 400ms；ARIA 播报一次性完成率 100% |
| 即时查词体验（UC-01） | 缓存与配额透明化 | ST-04, ST-05, ST-06 | M1 | 缓存命中标识正确率 100%；Quota Header 呈现率 100% |
| 即时查词体验（UC-01） | 语言对切换与订阅差异呈现 | ST-07, ST-08, ST-09 | M1 | 语言切换重查 P95 ≤ 2.5s；权益裁剪提示覆盖率 100% |
| 可靠降级编排（UC-02） | 熔断触发与模板回退 | ST-11, ST-16 | M1 | 降级响应 P95 ≤ 1.8s；模板加载成功率 ≥99.9% |
| 可靠降级编排（UC-02） | 告警提示与用户沟通 | ST-12, ST-15 | M1 | 降级提示延迟 ≤ 200ms；观测指标上报完整率 100% |
| 可靠降级编排（UC-02） | 半开探测与成本护栏 | ST-13, ST-14 | M2 | 半开成功率追踪；成本护栏触发后 5s 内切换 |
| 历史导出（UC-03） | 导出申请与配额校验 | ST-17, ST-18, ST-19 | M2 | 导出 202 回执 ≤ 5s；配额 429 提示准确率 100% |
| 历史导出（UC-03） | 下载交付与通知 | ST-20, ST-21 | M2 | 下载链接 TTL 600s；状态轮询更新 ≤ 5s |
| 历史导出（UC-03） | 生命周期治理 | ST-22 | M2 | 导出产物 T+7d 清理完成率 100% |
| 订阅权益（UC-04） | 升级续费与权益生效 | ST-23, ST-24, ST-26 | M3 | 支付成功→权益同步 ≤ 5s；Quota 镜像更新成功率 100% |
| 订阅权益（UC-04） | 到期降级与沟通 | ST-25, ST-27 | M3 | 到期任务延迟 ≤ 30s；提醒提前 ≥ 72h |
| 订阅权益（UC-04） | 审计与回滚补偿 | ST-28 | M3 | 审计事件完整率 100%；补偿重试上限 3 次 |
| 支付与账单（UC-05） | 订单创建与回调幂等 | ST-29, ST-30 | M3 | 支付成功率 ≥ 98%；幂等冲突率 < 0.1% |
| 支付与账单（UC-05） | 账单与收据交付 | ST-31 | M3 | 收据生成 ≤ 3s；下载链接 TTL 600s |
| 支付与账单（UC-05） | 退款对账与异常兜底 | ST-32, ST-33, ST-34 | M3 | 退款回滚延迟 ≤ 5s；对账差异 15 分钟内闭环；失败提示覆盖率 100% |
