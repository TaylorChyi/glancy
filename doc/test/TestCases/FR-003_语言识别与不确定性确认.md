# FR-003 语言识别与不确定性确认（Should）

- **前置**
  - 登录 Plus 用户，浏览器语言对设为 `en→zh`。
  - LID 服务可通过 `X-Debug-LID-Score` Header 注入模拟分值（0.85、0.65、0.45）。
  - 打开实验日志面板，确保能抓取 `lid_confidence` 事件。
- **步骤**
  1. 输入 `bonjour` 并提交，让 LID 返回 0.88（自动识别为法语）。
  2. 输入 `resume`，通过 Header 将置信度设为 0.65，观察弹出的语言确认对话框，选择“保留原语言对”。
  3. 输入混合字符 `abc123あ`，将置信度压至 0.45，尝试提交。
- **期望**
  - 步骤 1：系统自动将语言对切换为 `fr→zh` 或提示即将切换，用户无需额外操作即可查询。
  - 步骤 2：出现确认弹窗，包含 LID 置信度与建议语言；用户拒绝后查询保持原语言对且记录 `lid_confidence` 事件。
  - 步骤 3：请求被拒绝，返回错误提示与改写建议，且查询未发送到后端。
- **数据**
  - API：`POST /api/v1/lookup`（可附 `X-Debug-LID-Score`）。
  - 事件：`lid_confidence` 域包含 `score`、`decision=prompt|reject`。
  - 词条样本：`bonjour`、`resume`、`abc123あ`。
- **优先级**：P1（Should）
- **关联 UC**：UC-01，UC-12
- **关联 AC**：AC-FR-003，AC-UC-01，AC-UC-12
