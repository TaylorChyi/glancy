# FR-011 个性化例句与控制项（Must）

- **前置**
  - Free 与 Pro 两个测试账号；各自画像已设置不同学习目标。
  - 记录每个档位允许的例句数量与再生成上限（来自 SRS 第 11 章矩阵）。
  - 准备词条 `negotiate`（含较多风格变体）。
- **步骤**
  1. 使用 Free 账号查询 `negotiate`，记录默认例句条数与可用的难度/风格选项。
  2. 切换到 Pro 账号执行同一查询，依次点击“更难”“商务”“学术”等按钮，观察是否仅例句模块刷新。
  3. 在 Pro 账号上连续调用 `POST /lookup/{lookupId}/regenerate` 直到达到订阅上限，再发起一次请求。
  4. 将语言对切换为 `zh→zh`（同语），检查例句是否隐藏译文。
- **期望**
  - Free 档位限制例句条数、可用选项与矩阵一致；不可用选项应以升级提示呈现。
  - Pro 档位下，切换难度或风格只刷新例句模块，其他模块保持稳定；切换动作计入再生成配额而非查词配额。
  - 达到再生成上限后返回 429 `RATE_LIMITED`，`error.meta.kind=regenerate_quota`，UI 显示剩余冷却时间。
  - 同语模式下例句仅展示原文，无译文字段。
- **数据**
  - API：`POST /api/v1/lookup/{id}/regenerate`，Header 含 `X-Usage-Intent=examples`。
  - 配额字段：`X-Quota-Regenerate-Remaining`、`X-Quota-Reset-At`。
  - 档位矩阵：Free=2 条例句/无风格，Plus=3 条/双难度，Pro=5 条/多风格。
- **优先级**：P0（Must）
- **关联 UC**：UC-01，UC-02，UC-03
- **关联 AC**：AC-FR-011，AC-UC-02，AC-UC-03
