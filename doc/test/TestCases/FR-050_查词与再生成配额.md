# FR-050 查词与再生成配额（Must）

- **前置**
  - Plus 账号，配额：查词 200/日、再生成 100/日（以第 11 章矩阵为准）。
  - 能通过 `X-User-Timezone` Header 模拟本地时区（UTC+8）。
  - 工具脚本可批量调用查词与再生接口查看 Header。
- **步骤**
  1. 连续发起 5 次查词请求与 2 次再生成，请记录每次响应 Header：`X-Quota-Lookup-Remaining`、`X-Quota-Regenerate-Remaining`。
  2. 使用再生成接口消耗剩余额度，直至 `Remaining=0`，再发起一次请求触发 429。
  3. 修改客户端本地时间到次日 00:01（UTC+8），或通过沙箱将 `X-User-Timezone` 设为 `UTC+8` 并等待重置事件，重新发起查词，验证额度恢复。
- **期望**
  - 查词与再生成额度分开计数，Header Values 与仪表盘一致。
  - 超限请求返回 429，`error.meta.kind=quota`，响应体包含剩余冷却时间与重置时间戳。
  - 到达本地自然日 00:00 后两个配额自动重置至上限。
- **数据**
  - API：`POST /api/v1/lookup`、`POST /api/v1/lookup/{id}/regenerate`。
  - Header：`X-Quota-Lookup-Remaining`、`X-Quota-Regenerate-Remaining`、`X-Quota-Reset-At`。
  - 阈值：查词 200、再生 100（示例）。
- **优先级**：P0（Must）
- **关联 UC**：UC-01，UC-02，UC-03
- **关联 AC**：AC-FR-050，AC-UC-01，AC-UC-02，AC-UC-03
