# 附录 A 术语与缩略语

## A.1 目的与使用规则

- **目标**：统一文中出现的缩略语与关键术语，给出清晰、可执行的定义与计量口径。
- **适用范围**：适用于产品、设计、前后端、测试、运营与合规的所有交付物。
- **权威性**：如与其他材料不一致，以本章为准；未尽之处参见“附录 A 术语表”。
- **度量口径**：时间一律以 UTC 存储、按用户本地时区渲染；响应时间使用 ms 或 s；容量使用 KB 或 MB；优先级口径为 Must/Should/Could/Will not。

------

## A.2 通用缩略语总表

| 缩略语      | 中文全称（英文）                                  | 标准定义                                | 备注/口径                        |
| ----------- | ------------------------------------------------- | --------------------------------------- | -------------------------------- |
| API         | 应用程序接口（Application Programming Interface） | 系统对外提供的调用契约，采用 JSON/HTTPS | 契约版本化管理                   |
| FR          | 功能性需求（Functional Requirement）              | 描述系统“做什么”的需求项                | 采用 FR-XX 编号                  |
| NFR         | 非功能性需求（Non‑Functional Requirement）        | 描述性能、可靠性、安全等“如何做”的约束  | 采用 NFR-XX 编号                 |
| UC          | 用例（Use Case）                                  | 用户场景化操作序列                      | 采用 UC-XX 编号                  |
| MVP         | 最小可行产品（Minimum Viable Product）            | 首期最小实现范围                        | 与发布计划绑定                   |
| SLI         | 服务等级指标（Service Level Indicator）           | 可观测的度量，如错误率、延迟            | 与监控看板一致                   |
| SLO         | 服务等级目标（Service Level Objective）           | 对 SLI 的目标阈值                       | 例如月度可用性 99.9%             |
| SLA         | 服务等级协议（Service Level Agreement）           | 面向用户/合同的服务承诺                 | 与 SLO 区分管理                  |
| QPS         | 每秒请求数（Queries Per Second）                  | 吞吐度量与限流基线                      | 支持突发桶策略                   |
| P95/P99     | 第 95/99 百分位延迟                               | 端到端时延分位值                        | 采样窗口 5 分钟                  |
| TTL         | 存活时间（Time To Live）                          | 缓存或链接有效期                        | 下载链接默认 10 分钟             |
| RBAC        | 基于角色的访问控制（Role‑Based Access Control）   | 权限最小化模型                          | 后台与导出必须                   |
| OAuth       | 开放授权（OAuth 2.0）                             | 第三方登录授权框架                      | 依平台合规要求执行               |
| SDK         | 软件开发工具包（Software Development Kit）        | 第三方集成组件                          | 列入子处理者清单                 |
| CSV         | 逗号分隔值（Comma‑Separated Values）              | 导出文件格式                            | UTF‑8、带表头、脱敏              |
| JSON        | JavaScript 对象表示法                             | 导出/接口格式                           | UTF‑8、驼峰字段                  |
| UTC         | 协调世界时（Coordinated Universal Time）          | 统一存储时间标准                        | 前端本地渲染                     |
| CI          | 持续集成（Continuous Integration）                | 基于契约回放样本的自动校验              | 每次发布 ≥500 样本               |
| L1/L2 Cache | 一级/二级缓存                                     | L1 用户级短期缓存，L2 跨用户共享缓存    | L1 默认 10 分钟，L2 默认 30 分钟 |
| CB          | 熔断（Circuit Breaker）                           | 依赖异常时中断调用并快速失败            | 5xx≥5% 持续 1 分钟触发           |
| LID         | 语言识别（Language Identification）               | 判定输入语言的过程                      | p≥0.8 通过；0.6–0.8 需确认       |
| SSoT        | 单一事实源（Single Source of Truth）              | 唯一权威的数据或规则来源                | 订阅矩阵作为 SSoT                |
| H5          | HTML5 移动 Web                                    | 面向移动端的 Web 形态                   | 与 Web 端共享核心逻辑            |

> 注：表中默认口径与阈值按[第 1 章「文档约定」](<../第 1 章 引言.md#15-文档约定>)、[第 1 章「成功标准与关键指标」](<../第 1 章 引言.md#16-成功标准与关键指标>)与[第 1 章「技术实现最小集」](<../第 1 章 引言.md#147-技术实现最小集>)等条款执行。

------

## A.3 学习评测与语言学缩略语

| 缩略语    | 中文全称（英文）                                             | 定义/范围        | 用途                 |
| --------- | ------------------------------------------------------------ | ---------------- | -------------------- |
| CEFR      | 欧洲语言共同参考框架（Common European Framework of Reference） | A1–C2 六级       | 可读性映射与难度控制 |
| IELTS     | 国际英语语言测试系统（International English Language Testing System） | 0–9 分，含单项   | 用户画像输入         |
| TOEFL iBT | 托福网考（Test of English as a Foreign Language, Internet‑based Test） | 0–120 分，含单项 | 用户画像输入         |
| CET       | 大学英语考试（College English Test）                         | CET‑4/CET‑6 分数 | 用户画像输入         |

上述评分项用于生成时的**可读性映射与风格控制**，不对外展示原始分值。

------

## A.4 产品特有术语映射

| 术语              | 定义                                        | 计量/规则                                        | 备注               |
| ----------------- | ------------------------------------------- | ------------------------------------------------ | ------------------ |
| 词条              | 用户查询的目标文本                          | 字符串；内部小写存储、原样展示                   | 去首尾空白         |
| 语言对            | 源语言与目标语言的有序对                    | 受“语言对白名单”限制                             | 非白名单拒绝并提示 |
| 同语模式          | 源语=目标语（en→en、zh→zh）                 | 默认不显示译文                                   | 可由用户临时开启   |
| 释义与义项        | 词条语义条目集合                            | 相关性排序；默认展示 3 个                        | 支持多义项         |
| 个性化例句        | 结合用户画像生成的例句                      | 条数按订阅档位；支持难度/风格切换                | 支持再生成         |
| 常见/固定搭配     | 高频搭配/固定短语                           | 默认各 3 条                                      | 可展开更多         |
| 同义词/反义词     | 语义相近/相反词                             | 去重、相关性排序；默认 4 项                      | 词汇拓展           |
| 派生与词族        | 同词根/派生形态集合                         | 默认 2 项                                        | 形态关联           |
| 详略级别          | 输出长度预算                                | 短/中/长；中文 80/150/220，英文 120/220/320 字符 | 超限裁剪           |
| 再生成            | 同一词条+同一配置的二次生成                 | 次/日；独立于“查词”计数                          | 跨端共享           |
| 查词上限          | 每自然日允许的查询次数                      | 次/日；重试不计入                                | 超限返回 429       |
| 历史留存          | 系统保存的查询与结果记录                    | 留存时长与条数随档位                             | 支持按语言清理     |
| 无痕查询          | 不持久化历史                                | 仍计入配额与限流                                 | 仅保留会话渲染态   |
| 逻辑删除/物理清理 | 标记删除/实际删除                           | 逻辑删除即时；物理清理默认延迟 7 天              | 设可恢复窗口       |
| 画像/风格标签     | 学习目标、背景、水平、语域/体裁/语气/主题等 | 多选并可排序，档位限制最大可选数                 | 参与生成控制       |
| 订阅档位          | `FREE_USER`/`PLUS_USER`/`PRO_USER`（唯一 SSoT：[第 11 章 订阅、计费与账单](<../第 11 章 订阅、计费与账单.md>)） | 查词上限、例句条数、再生成次数、留存策略等差异化 | 到期自动降级       |

以上术语与口径与[第 1 章「实现范围」](<../第 1 章 引言.md#14-实现范围>)、[第 1 章「分层功能说明」](<../第 1 章 引言.md#143-分层功能说明>)、[第 1 章「订阅与权益概览」](<../第 1 章 引言.md#144-订阅与权益概览>)保持一致。

------

## A.5 技术与可观测性术语

| 术语                          | 定义                        | 规则                                                       |
| ----------------------------- | --------------------------- | ---------------------------------------------------------- |
| 结构化契约（Schema Contract） | 前后端/服务与模型的字段契约 | 采用语义化版本号 `glancy.dict.v1`；不兼容变更需提供弃用期  |
| 幂等/幂等键                   | 同一请求多次执行仅一次生效  | 幂等键 = hash(subject_id + lang_pair + entry_norm + config_hash + profile_etag) |
| 缓存命中                      | 命中缓存而非实时生成        | 记录 L1/L2 命中率；作为降本指标                            |
| 熔断/降级                     | 依赖异常时保护系统          | 熔断阈值与恢复策略固定；降级回退到基础释义与模板例句并提示 |
| trace_id                      | 贯穿调用链的唯一 ID         | 每请求生成；用于排障与对账                                 |
| tokens_in/out                 | 输入/输出 Token 数          | 计入成本统计，含重试分摊                                   |

上述规则与阈值以[第 1 章「技术实现最小集」](<../第 1 章 引言.md#147-技术实现最小集>)、[第 1 章「合规与隐私概览」](<../第 1 章 引言.md#19-合规与隐私概览>)、[第 1 章「成功标准与关键指标」](<../第 1 章 引言.md#16-成功标准与关键指标>)为准。

------

## A.6 计量单位与时间口径

- **时间**：`ms`、`s`；**容量**：`KB`、`MB`；**频度**：`次/日 (d)`；自然日重置按用户本地时区 00:00，服务端统一存 UTC。
- **下载链接 TTL**：默认 10 分钟，过期自动失效。
- **延迟统计**：端到端口径，采样窗口 5 分钟，滚动聚合；同时分解前端、后端、第三方分段延迟。

------

## A.7 文字符号与表示法

| 符号/表示         | 含义                      | 备注               |
| ----------------- | ------------------------- | ------------------ |
| `→`               | 语言方向（源语 → 目标语） | 例：zh → en        |
| `/`               | 二选一或并列              | 例：CSV/JSON       |
| `vMAJOR.MINOR`    | 契约语义化版本            | 例：glancy.dict.v1 |
| 驼峰（camelCase） | JSON 字段命名             | 导出与接口统一采用 |

------

## A.8 核心运行术语补充

| 术语       | 定义                                                         | 计量口径                                                    | 所属章节                                                    | 示例                                                         |
| ---------- | ------------------------------------------------------------ | ----------------------------------------------------------- | ----------------------------------------------------------- | ------------------------------------------------------------ |
| 降级       | 当上游依赖异常时，为保证可用性而回退到“基础释义 + 模板例句”等最小可用响应，并在 UI 明示退化状态。 | 依赖 5xx ≥ 5% 且持续 ≥ 1 分钟（或超时超阈）自动触发；退化请求计入配额但记 0 成本，降级率纳入可观测性看板。 | [第 7 章 7.4.5 熔断与降级](<../第 7 章 系统架构与组件.md#745-熔断与降级>)、[第 14 章 14.4 SLO 目标与错误预算](<../第 14 章 可观测性与运维（日志、监控、告警、SLO）.md#144-slo-目标与错误预算>) | Doubao API 在 1 分钟内持续出现 ≥5% 5xx，服务退化为基础释义并展示“已降级”徽标。 |
| 一次性链接 | 为导出结果或账单生成的、仅能在有效期内访问一次的签名下载链接，防止泄露与重复使用。 | 链接 TTL 10 分钟；生成回执 P95 ≤ 5 s；链接绑定用户主体并过期失效，需重新申请。 | [第 20 章 UC-06 导出验收矩阵](<../第 20 章 验收标准与测试方案（UC 对齐）.md#uc-06-导出>)、[第 12 章 12.2 数据最小化](<../第 12 章 安全、隐私与合规.md#122-数据最小化>) | 用户发起导出后 5 s 内收到回执与一次性链接，10 分钟内下载成功，超时需重新生成。 |
| 错误预算   | 在既定 SLO 下允许的最大不可用时间或失败比例，用于衡量可靠性消耗并驱动变更节奏。 | 月度可用性 99.9% 对应错误预算 43 分 12 秒/30 天；消耗 ≥50% 进入变更冻结，≥75% 启动高压值班，当月耗尽仅允许安全修复。 | [第 14 章 14.4 SLO 目标与错误预算](<../第 14 章 可观测性与运维（日志、监控、告警、SLO）.md#144-slo-目标与错误预算>) | 月度内故障累计 25 分钟，错误预算消耗 >50%，发布计划转入冻结窗口并追加回顾。 |

------

## A.9 跨章节术语索引（定义/计量/使用范围）

| 术语 | 定义 | 计量 | 使用范围/引用 |
| ---- | ---- | ---- | ------------- |
| 业务连续性计划（BCP） | 跨产品/设计/工程/合规协同的连续性策略，覆盖 SLA/SLO、降级矩阵、演练脚本与事件复盘，使故障具备可执行 Runbook。 | 13.4.1 覆盖的 DR-01～DR-06 均需按计划完成并在 13.5 事件库留档 ≥180 天；13.1.1 指标维持月度可用性 ≥99.9%。 | [第 13 章 13.1](<../第 13 章 可用性、容灾与备份.md#131-sla-指标>)、[第 13 章 13.4](<../第 13 章 可用性、容灾与备份.md#134-演练计划>) |
| 灾难恢复演练（DR 演练） | 以脚本化方式验证容灾能力的演练（如 DR-SQL-01、REL-ZD-01），覆盖数据库、跨区、成本、发布等场景。 | 频率按 13.4.1：降级每月、PITR 双月、跨区/成本每季度、重大发布前执行零停机演练；每次需提交 13.4.3 模板并与 20.10 验收联动。 | [第 13 章 13.4.1](<../第 13 章 可用性、容灾与备份.md#1341-频率与覆盖>)、[第 20 章 20.10](<../第 20 章 验收标准与测试方案（UC 对齐）.md#2010-配额限流与成本护栏测试>) |
| 零停机发布 | 通过蓝绿 + 灰度 + 自动回滚/kill switch 切换，保证功能发布期间用户 5xx=0。 | REL-ZD-01/DR-05 要求：灰度错误率 >0.1% 自动回滚，回滚 ≤5 min，契约回放 ≥500 条且恢复后通过率 100%。 | [第 13 章 13.4.2](<../第 13 章 可用性、容灾与备份.md#1342-演练脚本示例>)、[第 21 章 21.4](<../第 21 章 发布计划与灰度策略.md#214-放量策略灰度分层>)、[第 21 章 21.5](<../第 21 章 发布计划与灰度策略.md#215-守门人与回滚阈值>) |
| RTO（Recovery Time Objective） | 故障后恢复业务/数据所允许的最长时间窗。 | `lookups/results/profiles` ≤30 min、导出链路 ≤15 min、Redis ≤10 min（可重建）；按 13.1.4、DR-02/DR-04 演练测量。 | [第 13 章 13.1.4](<../第 13 章 可用性、容灾与备份.md#1314-rto-rpo-指标分解>)、[第 20 章 UC‑06](<../第 20 章 验收标准与测试方案（UC 对齐）.md#ac-uc-06>) |
| RPO（Recovery Point Objective） | 故障允许的最大数据丢失时间。 | 历史/配置/订阅域 RPO ≤5 min，Redis/限流计数可丢失；通过 PITR + 删除日志回放验证数据差异 ≤5 min。 | [第 13 章 13.1.4](<../第 13 章 可用性、容灾与备份.md#1314-rto-rpo-指标分解>)、[第 13 章 DR-02](<../第 13 章 可用性、容灾与备份.md#1343-验收清单与记录模板>) |
| Warm-Standby | 备用区域保持最小运行规模，随时可在跨区故障时提升为主区域。 | DR-03 规定提升 ≤30 min，切换日 SLA ≥99.0%、次日 ≥99.9%；演练结果需同步 13.4.3。 | [第 13 章 13.2.1](<../第 13 章 可用性、容灾与备份.md#1321-分层拓扑视图>)、[第 13 章 DR-03](<../第 13 章 可用性、容灾与备份.md#1343-验收清单与记录模板>) |
| Active‑Active | 多个实例同时对外提供服务的部署拓扑，常用于无状态层（CDN、网关、BFF、观测）。 | 需具备 AZ 冗余，单 AZ 故障仍满足 SLA ≥99.9%；发布按 21.4 阶梯切流，Kill switch 维持零停机。 | [第 13 章 13.2.1](<../第 13 章 可用性、容灾与备份.md#1321-分层拓扑视图>)、[第 21 章 21.4](<../第 21 章 发布计划与灰度策略.md#214-放量策略灰度分层>) |
| Active‑Standby | 主动/被动模式，主实例承载流量，备实例仅同步状态，常用于 RDBMS、Redis、对象存储。 | 主从复制延迟 >5 s 或写失败时触发提升，RTO ≤30 min，RPO ≤5 min；结合 PITR、删除日志回放验证。 | [第 13 章 13.2.2](<../第 13 章 可用性、容灾与备份.md#1322-组件级冗余与切换>)、[第 13 章 DR-02](<../第 13 章 可用性、容灾与备份.md#1343-验收清单与记录模板>) |
| 跨区域复制（CRR） | 对象存储/契约样本跨区域异步复制，保障导出与回放素材在灾备区域可用。 | 延迟 ≤60 s；超阈必须切换备区域并补发下载链接，TTL 10 分钟保持有效。 | [第 13 章 13.2.3](<../第 13 章 可用性、容灾与备份.md#1323-数据保护与备份br>)、[第 13 章 13.3](<../第 13 章 可用性、容灾与备份.md#133-降级矩阵>) |
| 时间点恢复（PITR） | 数据库基于 WAL 的时间点恢复手段，用于还原到故障前任意时间。 | RTO ≤30 min、RPO ≤5 min；演练需记录 `T0/T1`、删除日志回放结果，并在 DR-02 提交证据。 | [第 13 章 13.1.4](<../第 13 章 可用性、容灾与备份.md#1314-rto-rpo-指标分解>)、[第 13 章 DR-02](<../第 13 章 可用性、容灾与备份.md#1343-验收清单与记录模板>) |
| 合成探针 | 由监控系统发起的自动化请求，用于验证正常线路与强制降级线路的可用性。 | 两条线路每分钟发起 `/lookup`，与真实流量 SLI 偏差 ≤10%；探针失败即触发告警与降级联动。 | [第 6 章 非功能性需求（NFR）](<../第 6 章 非功能性需求（NFR）.md>)、[第 14 章 14.5.2](<../第 14 章 可观测性与运维（日志、监控、告警、SLO）.md#1452-合成探针正常降级双线路>)、[第 13 章 13.1.1](<../第 13 章 可用性、容灾与备份.md#1311-统计口径>) |
| Kill switch | 配置中心下发的紧急特性开关，用于即时切断新版本流量或禁用功能。 | 必须在 GR‑02 中预置并演练通过；DR-05 需验证自动回滚与手工开关均可零停机恢复并恢复 500 条契约回放。 | [第 21 章 21.4.3](<../第 21 章 发布计划与灰度策略.md#2143-灰度准入清单>)、[第 13 章 DR-05](<../第 13 章 可用性、容灾与备份.md#1343-验收清单与记录模板>) |
| 契约回放 | 以真实样本重放 API 契约的自动化校验，保障接口兼容性。 | 每次发布/灰度前 ≥500 条样本且通过率 100%，CI/CD 与变更单留痕；失败自动阻断放量。 | [第 21 章 21.4](<../第 21 章 发布计划与灰度策略.md#214-放量策略灰度分层>)、[第 20 章 20.2](<../第 20 章 验收标准与测试方案（UC 对齐）.md#202-相关事实源ssot>) |
| 错误预算消耗 | 用于度量 SLO 剩余额度的累计耗用百分比。 | 99.9% 月度 SLA 对应 43 分 12 秒；当日消耗 ≥5% 触发日报红标，累计 ≥50% 进入发布冻结，≥75% 启动高压值班，=100% 仅允许安全修复。 | [第 14 章 14.4](<../第 14 章 可观测性与运维（日志、监控、告警、SLO）.md#144-slo-目标与错误预算>) |
| 成本护栏 | 以日预算占用为触发信号的成本防护策略，优先保证查词可用。 | 80% 阈值启用强缓存（L2 优先、TTL×2）；95% 阈值禁用再生成、强制简化路径且 P95 恶化 ≤10%；DR-06 验证命中率 ≥80%。 | [第 10 章 10.7](<../第 10 章 配额、限流与成本控制.md#107-成本控制与预算护栏>)、[第 13 章 13.3](<../第 13 章 可用性、容灾与备份.md#133-降级矩阵>)、[第 13 章 DR-06](<../第 13 章 可用性、容灾与备份.md#1343-验收清单与记录模板>) |
| 成本燃率 | 近 5 分钟消耗/日预算比值，用于实时观测成本健康度。 | 正常需 ≤1.2×；>1.2× 告警，>1.5× 自动触发强缓存+关停再生成并纳入 OBS‑04 看板。 | [第 10 章 10.7](<../第 10 章 配额、限流与成本控制.md#107-成本控制与预算护栏>)、[第 14 章 14.3](<../第 14 章 可观测性与运维（日志、监控、告警、SLO）.md#143-监控总览>)、[第 21 章 21.4](<../第 21 章 发布计划与灰度策略.md#214-放量策略灰度分层>) |
| 预算护栏 | 安全/合规视角下对配额、限流和成本联动的统一策略，确保 429/限流语义一致。 | 429 响应必须带 `retry_after_ms` 与重置时间；80%/95% 阈值触发事件流记录 `costGuardrail=true` 并在 1 分钟内通知。 | [第 12 章 安全、隐私与合规](<../第 12 章 安全、隐私与合规.md>)、[第 20 章 20.10](<../第 20 章 验收标准与测试方案（UC 对齐）.md#2010-配额限流与成本护栏测试>) |
| 令牌桶（Token Bucket） | 速率限制算法，用户/租户/全局三层共享，配额在自然日重置。 | 默认速率参见 10.4 档位表；令牌秒级补充，桶满不溢出；命中时返回 429 + `X-RateLimit`/`X-Quota` 头。 | [第 10 章 10.4](<../第 10 章 配额、限流与成本控制.md#104-限流与突发控制>)、[第 17 章 17.3](<../第 17 章 反滥用与风控策略.md#173-在线信号signals>) |
| 突发桶（Burst Bucket） | 用于处理短时高峰的额外令牌池。 | 初始突发系数 3×、窗口 5 min；占用率 >80% 需降档或强缓存，演练场景要求 5 分钟内回落（16-AC-02）。 | [第 6 章 非功能性需求（NFR）](<../第 6 章 非功能性需求（NFR）.md>)、[第 16 章 16.3](<../第 16 章 端到端性能与容量规划.md#163-设计基线与硬约束>)、[第 17 章 17.3](<../第 17 章 反滥用与风控策略.md#173-在线信号signals>) |
| 滑动窗口限流 | 按滚动时间窗口统计请求量/事件数的限流策略。 | 风控规则默认 5 分钟窗口；命中阈值立即降档（限速 0.3× 或关闭再生成），并记录 `risk_feature_log`。 | [第 17 章 17.4.1](<../第 17 章 反滥用与风控策略.md#1741-事件级别与特征抽取>)、[第 7 章 7.6](<../第 7 章 系统架构与组件.md#76-缓存策略与一致性>) |
| 强缓存优先 | 将 L2→L1 作为必经路径，MISS 才退化到实时生成，TTL 动态翻倍。 | 触发于成本护栏 80% 或风险等级 ≥R2；DR-06 要求命中率 ≥80%、P95 恶化 <10%，恢复后自动撤销。 | [第 13 章 13.3](<../第 13 章 可用性、容灾与备份.md#133-降级矩阵>)、[第 16 章 16.2](<../第 16 章 端到端性能与容量规划.md#162-术语与度量口径>)、[第 17 章 17.3](<../第 17 章 反滥用与风控策略.md#173-在线信号signals>) |
| 配额补偿任务 | 在数据库切换或重放后对用户配额计数进行修正的后台任务。 | DR-SQL-01 要求切换后立即回放删除队列与配额补偿，确保 RPO ≤5 min、配额一致性在 30 min 内恢复。 | [第 13 章 13.4.2](<../第 13 章 可用性、容灾与备份.md#1342-演练脚本示例>)、[第 13 章 13.5](<../第 13 章 可用性、容灾与备份.md#135-回溯机制>) |
| 删除日志回放 | 通过重放删除/补偿日志来对账恢复期间的数据差异。 | PITR 演练需完成删除日志回放并提交截图；差异需 ≤RPO（5 min），否则视为演练失败。 | [第 13 章 13.1.4](<../第 13 章 可用性、容灾与备份.md#1314-rto-rpo-指标分解>)、[第 13 章 DR-02](<../第 13 章 可用性、容灾与备份.md#1343-验收清单与记录模板>) |
| 双人复核 | 对敏感操作（权限、风控、白名单等）要求两名不同角色审批并审计。 | 权限变更必须由申请人+复核人签字并写入审计；风控后台“风险解除”需双人复核；抽检覆盖率 100%。 | [第 12 章 安全、隐私与合规](<../第 12 章 安全、隐私与合规.md>)、[第 17 章 17.5](<../第 17 章 反滥用与风控策略.md#175-处置动作矩阵渐进式>) |
| 审计留痕 | 对所有敏感事件保留可回放的日志、trace 与截图。 | 需包含 `trace_id`、熔断/降级标识、命令哈希，留存 ≥180 天；导出/删除操作写入 9.10 审计表。 | [第 13 章 13.5.1](<../第 13 章 可用性、容灾与备份.md#1351-事件追踪与审计>)、[第 9 章 9.10](<../第 9 章 数据模型与数据治理.md#910-访问控制与脱敏>) |
| 数据最小化 | 只收集/留存反滥用与业务所需的最少数据，并按分级处理。 | 无痕查询不落原文；S2/S3 数据按 9.3 分级留存；风控 `risk_feature_log` 仅存脱敏摘要；定期执行留存策略。 | [第 9 章 数据模型与数据治理](<../第 9 章 数据模型与数据治理.md>)、[第 12 章 12.2](<../第 12 章 安全、隐私与合规.md#122-数据最小化>)、[第 17 章 17.3](<../第 17 章 反滥用与风控策略.md#173-在线信号signals>) |
| 脱敏导出 | 导出文件只包含必须字段并进行列级脱敏，下载链接一次性。 | UC‑06 要求 `POST /exports` 202 回执 P95 ≤5 s，链接 TTL 10 min，CSV UTF‑8、带表头、字段脱敏。 | [第 8 章 8.6 导出](<../第 8 章 接口与数据契约（APISchema）.md#86-导出>)、[第 12 章 12.10](<../第 12 章 安全、隐私与合规.md#1210-隐私与数据主体权利dsr>)、[第 20 章 UC‑06](<../第 20 章 验收标准与测试方案（UC 对齐）.md#ac-uc-06>) |
| 风险分级（R0–R3） | 反滥用评分体系，基于 0–100 分将请求划分为正常/可疑/高风险/阻断。 | R0：0–24 放行；R1：25–49 限速 0.5×；R2：50–79 强缓存+禁再生；R3：80–100 返回 4xx 并可冻结凭证；窗口默认 5 min。 | [第 17 章 17.4](<../第 17 章 反滥用与风控策略.md#174-风险分级与评分在线>) |
| Sunset 头 | HTTP 响应头，告知旧版本契约的弃用时间与迁移指引。 | 非兼容变更必须提供 ≥90 天 Sunset；响应附 `Link: rel="deprecation"`，并在 22.16 日历登记。 | [第 22 章 22.5](<../第 22 章 变更管理与版本策略（契约弃用期）.md#225-弃用期deprecation--sunset政策>)、[第 8 章 接口与数据契约](<../第 8 章 接口与数据契约（APISchema）.md>) |
| 棕断演练（Brown-out） | 在弃用期内短时注入限流/错误以验证客户端是否已迁移。 | 至少执行 D-60、D-30 或 D-7 的 30 分钟演练；未升级客户端名单需记录并发公告；终态返回 `410 Gone / CONTRACT_RETIRED`。 | [第 22 章 22.5](<../第 22 章 变更管理与版本策略（契约弃用期）.md#225-弃用期deprecation--sunset政策>)、[第 21 章 21.4](<../第 21 章 发布计划与灰度策略.md#214-放量策略灰度分层>) |

### A.9.1 产品与体验术语（定义/计量/使用范围）

| 术语 | 定义 | 计量 | 使用范围/引用 |
| ---- | ---- | ---- | ------------- |
| <a id="lookup-request"></a>查词请求 | 面向终端用户的主查询入口，调用 `POST /api/v1/lookup` 以获取结构化释义与关联模块。 | 计入 `lookup` 日配额；首屏响应 P95 ≤2.5 s；命中缓存需返回 `X-Cache: HIT`。 | [第 4 章 UC-01](<../第 4 章 业务流程与用例.md#uc-01-查询词条>)、[第 8 章 8.4](<../第 8 章 接口与数据契约（APISchema）.md#84-post-api-v1-lookup>)、[第 20 章 AC-UC-01](<../第 20 章 验收标准与测试方案（UC 对齐）.md#ac-uc-01>) |
| <a id="regenerate-request"></a>再生成请求 | 对既有查询结果进行个性化刷新或难度/风格切换的调用，接口为 `POST /api/v1/lookup/{lookupId}/regenerate`。 | 计入 `regenerate` 日配额；默认绕过 L2 缓存；超限返回 429 并附带 `X-Quota` 头。 | [第 2 章 目标](<../第 2 章 产品范围与目标.md#核心场景>), [第 8 章 8.4](<../第 8 章 接口与数据契约（APISchema）.md#84-post-api-v1-lookup>), [第 20 章 UC‑02](<../第 20 章 验收标准与测试方案（UC 对齐）.md#uc-02-再生成>) |
| <a id="module-flags"></a>moduleFlags | 请求体中的模块显隐控制字段，使用布尔 map 表示需返回的内容块。 | key 集合覆盖释义、例句、搭配、同/反义、派生模块；`FREE_USER` 档仅支持开关，`PLUS_USER`/`PRO_USER` 支持排序与详略调节。 | [第 1 章 1.4.4](<../第 1 章 引言.md#144-订阅与权益概览>), [第 8 章 8.4](<../第 8 章 接口与数据契约（APISchema）.md#84-post-api-v1-lookup>) |
| <a id="detail-level"></a>detailLevel | 控制输出详略的枚举字段，取值 `SHORT/MEDIUM/LONG`。 | 中文 80/150/220 字符、英文 120/220/320 字符预算；超限需裁剪并在响应体标注。 | [第 8 章 8.3](<../第 8 章 接口与数据契约（APISchema）.md#83-领域对象概览json-schema-摘要>), [第 20 章 AC-FR-011](<../第 20 章 验收标准与测试方案（UC 对齐）.md#ac-fr-011>) |
| <a id="example-count"></a>exampleCount | 请求中指定例句数量的字段，用于控制 `examples` 模块返回条数。 | 整数 ≥0；`FREE_USER`/`PLUS_USER`/`PRO_USER` 默认 1/3/5 条；超过档位限制需降级到最大允许值并返回提示。 | [第 2 章 权益](<../第 2 章 产品范围与目标.md#产品能力与非功能目标>), [第 8 章 8.4](<../第 8 章 接口与数据契约（APISchema）.md#84-post-api-v1-lookup>), [第 20 章 UC‑03](<../第 20 章 验收标准与测试方案（UC 对齐）.md#uc-03-难度风格切换>) |
| <a id="device-fingerprint"></a>deviceFingerprint | 由 `ua|widthxheight|lang|tz|platform|uaVersion` 归一化拼接并经 SHA‑256 计算出的哈希，用于识别“同一设备”的游客行为。 | `POST /api/v1/sessions/guest` 必填；缺失默认返回 `DEVICE_FINGERPRINT_REQUIRED`；仅在配额/风控中使用，不落真实原文。 | [第 8 章 8.1.1](<../第 8 章 接口与数据契约（APISchema）.md#811-guest-session>), [第 12 章 12.4.2](<../第 12 章 安全、隐私与合规.md#1242-device-fp>) |
| <a id="result-flavor"></a>Flavor | 查词结果的呈现风格枚举，用于区分双语、例句强化等展现模式。 | 取值如 `BILINGUAL`、`EXAMPLE_FOCUS`；与用户偏好及档位绑定，写入历史与缓存键。 | [第 3 章 用户画像](<../第 3 章 用户画像与角色.md#32-学习偏好>), [第 8 章 8.0.1](<../第 8 章 接口与数据契约（APISchema）.md#801-当前实现表代码事实源>), [第 9 章 9.2](<../第 9 章 数据模型与数据治理.md#92-数据域与表结构>) |
| <a id="capture-history-flag"></a>captureHistory | 控制是否记录查询历史的请求参数，适用于 `GUEST` 或无痕场景。 | 默认 `true`；当 `false` 时不写入 `lookups/results/history` 正文，仅累积 `quota_daily` 计数。 | [第 8 章 8.0.1](<../第 8 章 接口与数据契约（APISchema）.md#801-当前实现表代码事实源>), [第 9 章 9.3](<../第 9 章 数据模型与数据治理.md#93-数据分级与留存策略>) |
| <a id="persona-summary"></a>personaSummary | 个性化结果中的学习者概况摘要，帮助用户快速理解定制理由。 | 字符数 ≤120；随用户画像更新即时生效；支持 i18n。 | [第 3 章 3.3](<../第 3 章 用户画像与角色.md#33-画像属性>), [第 8 章 8.3.1](<../第 8 章 接口与数据契约（APISchema）.md#831-dictresult查词结果骨架>) |
| <a id="learning-hooks"></a>learningHooks | 结合用户画像生成的学习提示列表，用于引导下一步练习。 | 数组长度 1–5；每条 ≤80 字符；按档位决定最大条数。 | [第 2 章 核心能力](<../第 2 章 产品范围与目标.md#产品能力与非功能目标>), [第 8 章 8.3.1](<../第 8 章 接口与数据契约（APISchema）.md#831-dictresult查词结果骨架>) |
| <a id="reflection-prompts"></a>reflectionPrompts | 促使用户复盘学习效果的提示语集合。 | 数组长度 1–3；须与 `personaSummary` 语言一致；过期后自动更新。 | [第 2 章 核心能力](<../第 2 章 产品范围与目标.md#产品能力与非功能目标>), [第 8 章 8.3.1](<../第 8 章 接口与数据契约（APISchema）.md#831-dictresult查词结果骨架>) |

### A.9.2 工程与平台术语（定义/计量/使用范围）

| 术语 | 定义 | 计量 | 使用范围/引用 |
| ---- | ---- | ---- | ------------- |
| <a id="idempotency-key"></a>Idempotency-Key | 写操作请求幂等校验使用的 SHA-256 哈希，确保重复提交只生效一次。 | 推荐 `hash(subjectId+langPair+entryNorm+configHash+profileEtag)`；有效期 30 s；冲突率需 ≤0.1%。 | [第 8 章 8.1](<../第 8 章 接口与数据契约（APISchema）.md#81-基线规范>), [第 11 章 11.6.4](<../第 11 章 订阅、计费与账单.md#1164-变更与并发>), [第 20 章 20.3](<../第 20 章 验收标准与测试方案（UC 对齐）.md#203-api-契约验证>) |
| <a id="subject-id"></a>subjectId | 将用户或 `GUEST` 会话统一抽象为幂等、配额与审计主体的标识。 | 登录用户 `u_<userId>`，`GUEST` `s_<sessionId>`；贯穿缓存键、quota 与日志。 | [第 8 章 8.1](<../第 8 章 接口与数据契约（APISchema）.md#81-基线规范>), [第 9 章 9.2](<../第 9 章 数据模型与数据治理.md#92-数据域与表结构>) |
| <a id="entry-norm"></a>entryNorm | 词条正规化结果，用于幂等与缓存键的一致性处理。 | 统一小写、去首尾空白、去掉多余空格；写入缓存/数据库使用 `entry_norm` 字段。 | [第 4 章 BR-10](<../第 4 章 业务流程与用例.md#业务规则br>), [第 8 章 8.4](<../第 8 章 接口与数据契约（APISchema）.md#84-post-api-v1-lookup>) |
| <a id="config-hash"></a>configHash | 将模块开关、详略级别等配置组合成的哈希，用于缓存与幂等。 | 对请求体中的 `moduleFlags`、`detailLevel`、`exampleCount`、偏好等字段按字母序序列化后 SHA-256。 | [第 8 章 8.4](<../第 8 章 接口与数据契约（APISchema）.md#84-post-api-v1-lookup>), [第 20 章 TC‑API‑003](<../第 20 章 验收标准与测试方案（UC 对齐）.md#tc-api-003-idempotency-生效>) |
| <a id="profile-etag"></a>profileEtag | 用户画像配置的版本指纹，确保生成结果与最新偏好同步。 | 32 字节十六进制字符串；画像更新后立即刷新；未匹配时强制重新生成。 | [第 3 章 3.3](<../第 3 章 用户画像与角色.md#33-画像属性>), [第 8 章 8.4](<../第 8 章 接口与数据契约（APISchema）.md#84-post-api-v1-lookup>), [附录 C 时序图](<./附录 C 图示（系统上下文、时序、状态机）.md#c3-查词主链路时序图>) |
| <a id="tokens-in"></a>tokensIn | 模型输入令牌计数，用于成本估算与预算护栏。 | 非负整数；与 `tokensOut` 一同写入 `results`、`cost_counters`；超阈触发成本护栏。 | [第 8 章 8.3](<../第 8 章 接口与数据契约（APISchema）.md#83-领域对象概览json-schema-摘要>), [第 10 章 10.7](<../第 10 章 配额、限流与成本控制.md#107-成本控制与预算护栏>) |
| <a id="tokens-out"></a>tokensOut | 模型输出令牌计数，用于观测与计费。 | 非负整数；写入 `results` 与 `cost_counters`；异常波动触发 OBS-04 看板。 | [第 8 章 8.3](<../第 8 章 接口与数据契约（APISchema）.md#83-领域对象概览json-schema-摘要>), [第 14 章 14.3](<../第 14 章 可观测性与运维（日志、监控、告警、SLO）.md#143-监控总览>) |
| <a id="degraded-flag"></a>degraded | 标识响应是否处于降级模式的布尔字段。 | `true` 时仅返回“基础释义 + 模板例句”；降级率 >5% 触发 P1 告警；纳入错误预算统计。 | [第 7 章 7.4.5](<../第 7 章 系统架构与组件.md#745-熔断与降级>), [第 14 章 14.4](<../第 14 章 可观测性与运维（日志、监控、告警、SLO）.md#144-slo-目标与错误预算>), [第 20 章 UC‑14](<../第 20 章 验收标准与测试方案（UC 对齐）.md#uc-14-降级与熔断>) |
| <a id="x-trace-id"></a>X-Trace-Id | 请求与响应携带的全链路追踪头，用于串联日志与审计。 | 字符长度 16–32；必须镜像到响应；写入 `audit_events.trace_id`。 | [第 8 章 8.1](<../第 8 章 接口与数据契约（APISchema）.md#81-基线规范>), [第 14 章 14.2](<../第 14 章 可观测性与运维（日志、监控、告警、SLO）.md#142-链路追踪与日志策略>) |
| <a id="x-cache"></a>X-Cache | 缓存命中标头，标识响应是否来自 L1/L2。 | 取值 `HIT/MISS/BYPASS`；命中时仍计入 `lookup` 配额；纳入缓存命中率指标。 | [第 5 章 FR-071](<../第 5 章 功能性需求（FR）.md#fr-070-079-缓存与性能>), [第 16 章 表 16-1](<../第 16 章 端到端性能与容量规划.md#161-容量假设与测算>), [第 20 章 TC-CACHE-001](<../第 20 章 验收标准与测试方案（UC 对齐）.md#tc-cache-001-缓存命中验证>) |

### A.9.3 观测、配额与合规术语（定义/计量/使用范围）

| 术语 | 定义 | 计量 | 使用范围/引用 |
| ---- | ---- | ---- | ------------- |
| <a id="x-ratelimit-limit"></a>X-RateLimit-Limit | 响应头中声明当前窗口允许的最大请求数。 | 整数；默认与订阅档位绑定；需与 `rate_limits` 表保持一致。 | [第 8 章 8.1](<../第 8 章 接口与数据契约（APISchema）.md#81-基线规范>), [第 10 章 10.4](<../第 10 章 配额、限流与成本控制.md#104-限流与突发控制>) |
| <a id="x-ratelimit-remaining"></a>X-RateLimit-Remaining | 响应头中声明当前窗口剩余可用次数。 | 整数 ≥0；命中限流时返回 0 并伴随 429。 | [第 8 章 8.1](<../第 8 章 接口与数据契约（APISchema）.md#81-基线规范>), [第 10 章 10.4](<../第 10 章 配额、限流与成本控制.md#104-限流与突发控制>) |
| <a id="x-ratelimit-reset"></a>X-RateLimit-Reset | 响应头中指示限流窗口的重置时间戳。 | Unix epoch 秒；需与 `rate_limits.reset_at` 同步，允许 ±1 s 偏差。 | [第 8 章 8.1](<../第 8 章 接口与数据契约（APISchema）.md#81-基线规范>), [第 10 章 10.4](<../第 10 章 配额、限流与成本控制.md#104-限流与突发控制>) |
| <a id="x-quota-type"></a>X-Quota-Type | 告知消费的配额类型（查词或再生）的响应头。 | 取值 `lookup` 或 `regenerate`；需与请求体动作一致。 | [第 8 章 8.1](<../第 8 章 接口与数据契约（APISchema）.md#81-基线规范>), [第 20 章 UC‑02](<../第 20 章 验收标准与测试方案（UC 对齐）.md#uc-02-再生成>) |
| <a id="x-quota-remaining"></a>X-Quota-Remaining | 当前配额剩余次数的响应头。 | 整数 ≥0；命中强缓存时不减少；配额耗尽返回 0 并提示冷却时间。 | [第 8 章 8.1](<../第 8 章 接口与数据契约（APISchema）.md#81-基线规范>), [第 10 章 10.2](<../第 10 章 配额、限流与成本控制.md#102-配额定义与层级>) |
| <a id="x-quota-reset-at"></a>X-Quota-Reset-At | 表示自然日重置时间的 ISO8601 时间戳。 | 使用用户本地时区；与 `quota_daily.time_zone` 对齐；误差 ≤1 分钟。 | [第 8 章 8.1](<../第 8 章 接口与数据契约（APISchema）.md#81-基线规范>), [第 9 章 9.5](<../第 9 章 数据模型与数据治理.md#95-日志与指标留存>) |
| <a id="quota-payload"></a>quota 对象 | 响应体镜像配额状态的 JSON 对象，包含 `type/remaining/resetAt`。 | 字段与 `X-Quota-*` 头一致；`resetAt` 采用 ISO8601；需在降级时保留。 | [第 8 章 8.1](<../第 8 章 接口与数据契约（APISchema）.md#81-基线规范>), [第 20 章 TC-QUOTA-001](<../第 20 章 验收标准与测试方案（UC 对齐）.md#tc-quota-001-配额头校验>) |
| <a id="retry-after-ms"></a>Retry-After | 429/503 响应中指示再次尝试时间的头或体字段。 | 单位 ms；与限流窗口一致；429 必须携带。 | [第 8 章 8.10](<../第 8 章 接口与数据契约（APISchema）.md#810-错误模型与码表>), [第 10 章 10.4](<../第 10 章 配额、限流与成本控制.md#104-限流与突发控制>) |
| <a id="quota-daily-table"></a>quota_daily | 记录主体在自然日内配额消耗的持久化表。 | 主键 `subject_id + quota_date_local`；留存 180 天；无痕查询仅增计数。 | [第 9 章 9.2](<../第 9 章 数据模型与数据治理.md#92-数据域与表结构>), [第 10 章 10.2](<../第 10 章 配额、限流与成本控制.md#102-配额定义与层级>) |
| <a id="rate-limits-table"></a>rate_limits | 存储各主体限速窗口与突发状态的持久化表。 | 包含 `limit/remaining/reset_at/burst_tokens`；留存 90 天；驱动合规审计。 | [第 9 章 9.2](<../第 9 章 数据模型与数据治理.md#92-数据域与表结构>), [第 10 章 10.4](<../第 10 章 配额、限流与成本控制.md#104-限流与突发控制>) |
| <a id="audit-events-table"></a>audit_events | 记录敏感操作与可回放事件的审计日志表。 | 保留 365–730 天；字段含 `event_type, subject_id, trace_id, payload`；写入需双人复核。 | [第 9 章 9.2](<../第 9 章 数据模型与数据治理.md#92-数据域与表结构>), [第 12 章 12.4](<../第 12 章 安全、隐私与合规.md#124-审计与证据保全>), [第 14 章 14.2](<../第 14 章 可观测性与运维（日志、监控、告警、SLO）.md#142-链路追踪与日志策略>) |
| <a id="abuse-events-table"></a>abuse_events | 反滥用决策事件表，记录风险评分与处置动作。 | 留存 ≥180 天；字段含 `risk_score, action, reason, trace_id`；支持申诉回写。 | [第 17 章 17.4](<../第 17 章 反滥用与风控策略.md#174-风险分级与评分在线>), [第 12 章 12.6](<../第 12 章 安全、隐私与合规.md#126-滥用与申诉处理>) |
