# 第 1 章 引言

## 1.1 文档目的

本章明确 Glancy 个性化电子词典在 MVP 阶段的目标、实现范围、关键约束与成功标准。文本作为产品、设计、研发、测试、运营与法务的统一依据，确保需求明确、可落地、可验收与可追溯。

## 1.2 项目概述与愿景

| 主题     | 说明                                                         |
| -------- | ------------------------------------------------------------ |
| 项目概述 | Glancy 是个性化电子词典。系统接入 Doubao API，通过提示词模板与用户画像生成贴合学习目标与近期查词历史的释义与例句。系统输出以理解效率为核心目标。 |
| 核心价值 | 提升可理解度与相关性，提供直接的输出结构，降低使用门槛与配置成本。 |
| 产品愿景 | 实现“查询即理解”，为后续记忆与复习能力预留数据与接口基础。   |

## 1.3 读者对象与阅读建议

| 读者角色     | 关注重点                                                     |
| ------------ | ------------------------------------------------------------ |
| 产品与交互   | 实现范围、输出结构、分层能力                                 |
| 前端与 H5 端 | 输入校验、模块渲染、设置项、语言切换                         |
| 后端与平台   | 账户体系、订阅、配额、历史记录、数据控制、第三方登录与支付对接 |
| 提示词工程   | 语言对白名单、例句生成控制、风格控制、难度控制               |
| 测试与验收   | 输入限制、分层配额、清理规则、导出能力                       |
| 法务与合规   | 使用条款、隐私政策、数据主体权利、留存与清理策略             |

## 1.4 实现范围

本节仅呈现 MVP 阶段的实现内容。输入仅接受单词或词组，若用户输入整句，系统提示改为词或词组。

### 1.4.1 语言对白名单

| 序号 | 语言对  | 模式说明                |
| ---- | ------- | ----------------------- |
| L1   | zh → en | zh 到 en 翻译           |
| L2   | en → zh | en 到 zh 翻译           |
| L3   | en → en | en 到 en 同语释义与例句 |
| L4   | zh → zh | zh 到 zh 同语释义与例句 |

同语模式不显示译文。

### 1.4.2 输入与查词规则

| 项目     | 规定                                                         |
| -------- | ------------------------------------------------------------ |
| 输入类型 | 仅接受单词或词组                                             |
| 句子输入 | 不接受；判定规范遵循[第 8 章「句子输入判定规范」](<./第 8 章 接口与数据契约（APISchema）.md#8100-句子输入判定规范>)，触发时返回 ENTRY_NOT_WORD_OR_PHRASE |
| 上下文   | 支持简短词组输入以提升相关性                                 |
| 输出范围 | 词典具备的模块全部可输出，默认全部开启。用户可在设置中调整模块开关、顺序与详略级别 |
| 释义呈现 | 展示多义项并按相关性排序，不提供原因说明                     |
| 译文显示 | 默认显示译文，en → en 与 zh → zh 模式不显示译文              |

### 1.4.3 分层功能说明

本节聚焦“前端与 H5 端”需要共识的能力差异，详细权益、配额与价格均以[第 11 章 订阅、计费与账单](<./第 11 章 订阅、计费与账单.md>)为唯一权威（Single Source of Truth）。

- **档位命名**：Free / Plus / Pro。任何历史文档中的“普通档/Basic”等同义词均已作废。
- **例句控制**：三档均支持难度与风格切换，该操作计入再生成。例句数量、可调范围与是否显示译文等细项由[第 11 章 订阅、计费与账单](<./第 11 章 订阅、计费与账单.md>)定义。
- **模块控制**：请求体统一使用 `moduleFlags` 布尔开关，响应体承载 `modules` 内容容器。默认模块集合包括释义、个性化例句、常见搭配、固定搭配、词形变化、词根词缀词源、同义词、反义词以及派生与词族；详略级别与条数随档位调整。
- **历史与导出**：各档默认留存天数、条数上限与导出能力以[第 11 章 订阅、计费与账单](<./第 11 章 订阅、计费与账单.md>)为准。删除语义一致：即时逻辑删除，物理清理 T+7 天完成。
- **无痕与匿名**：Free 档起支持无痕查询；匿名主体的配额为 Free 档日配额的 1/3，通过[第 8 章「匿名会话与配额」](<./第 8 章 接口与数据契约（APISchema）.md#811-匿名会话与-token-获取>)规范接入。

统一详略级别基线保持不变，用于界面排版参考：

| 级别 | 中文字符上限 | 英文字符上限 |
| ---- | ------------ | ------------ |
| 短   | 80 字符      | 120 字符     |
| 中   | 150 字符     | 220 字符     |
| 长   | 220 字符     | 320 字符     |

### 1.4.4 订阅与权益概览

订阅权益、付费通道、配额阈值与生效/失效策略全部由[第 11 章 订阅、计费与账单](<./第 11 章 订阅、计费与账单.md>)维护，其他章节仅引用不复制。本章仅提醒：MVP 阶段的付费范围限定在 Web/H5，支付渠道为微信支付与支付宝，自动续费默认不启用。

### 1.4.5 支付与账单

| 项目           | 说明                                       |
| -------------- | ------------------------------------------ |
| 订阅开通与续费 | 支付成功后权限即时生效。                   |
| 到期处理       | 到期后自动降级并同步能力边界。             |
| 账单与收据     | 展示订阅档位、生效时间、到期时间与订单号。 |
| 退款与异常     | 遵循目标平台规则，保持状态与权限幂等同步。 |

### 1.4.6 通用设置

| 设置项   | 取值                     | 默认值   |
| -------- | ------------------------ | -------- |
| 主题     | 浅色、深色、跟随系统     | 跟随系统 |
| 快捷键   | 提供默认方案，允许自定义 | 开启     |
| 界面语言 | zh、en                   | zh       |

### 1.4.7 技术实现最小集

| 模块            | 要求                                                         |
| --------------- | ------------------------------------------------------------ |
| Doubao API 适配 | 提供稳定封装、重试、超时、错误语义化、结构化契约与解析容错。 |
| 缓存与降级      | 对同一用户、同一词条、同一配置提供短时缓存。外部异常时降级为基础释义与模板例句并提示。 |
| 账户与订阅      | 提供注册、登录、第三方登录（微信、Apple、Google）。订阅状态与权限实时同步与对账。 |
| 历史记录        | 提供保存、清理、导出功能，支持按语言清理与全部清空。         |

## 1.5 文档约定

| 项目       | 规范                                                         |
| ---------- | ------------------------------------------------------------ |
| 需求编号   | 功能性需求使用前缀 FR 编号，非功能性需求使用前缀 NFR 编号，用例使用前缀 UC 编号，接口使用前缀 API 编号。 |
| 优先级     | 使用 Must、Should、Could、Will not 四级。                    |
| 时间与度量 | 响应时间使用 ms 或 s，容量使用 KB 或 MB，百分比保留 2 位小数。时间使用 UTC 存储，前端按本地时区渲染。 |

## 1.6 成功标准与关键指标

| 类别       | 指标                 | 目标              |
| ---------- | -------------------- | ----------------- |
| 性能       | 首屏查词端到端 P95   | ≤ 2.5 s           |
| 性能       | 首屏查词平均值       | ≤ 1.2 s           |
| 质量       | 结构化输出正确率     | ≥ 99%             |
| 质量       | 例句可理解度正反馈   | ≥ 80%             |
| 账号与订阅 | 登录成功率           | ≥ 99%             |
| 账号与订阅 | 订阅开通与续费成功率 | ≥ 98%             |
| 数据控制   | 清理与导出完成时间   | ≤ 5 s，并提供回执 |
| 数据控制   | 无痕查询留存         | 0 条              |

## 1.7 项目边界与基本假设
